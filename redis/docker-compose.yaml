services:
  redis:
    # 使用微软官方的 Redis 镜像
    image: redis:8.2.1-bookworm

    # 重启策略：除非手动停止，否则容器会自动重启
    restart: unless-stopped

    # 容器名称
    container_name: redis-server

    # 端口映射：将主机的 6379 端口映射到容器的 6379 端口
    # 如果您主机的 6379 端口已被占用（例如已安装了 Redis），
    # 可以修改前面的数字，如 "6380:6379"
    ports:
      - "6379:6379"

    # 数据卷映射：将容器内的 /data 目录（Garnet默认数据目录）
    # 映射到当前目录下的 data/ 文件夹，实现数据持久化
    volumes:
      - ./data:/data

    # 容器的健康检查，确保服务正常运行
    healthcheck:
      test: ["CMD", "redis-cli", "-h", "localhost", "-p", "6379", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5

networks:
  default:
    name: redis_network
